# 파일명 패턴 예시

## 기본 패턴

```
(기관명-공문번호 (본문/첨부) 부서명) [제출/붙임N] 제목.확장자
```

## 정규표현식

```javascript
/\(([^-]+)-(\d+)\s+\((본문|첨부)\)[^)]*\)/
```

`[^)]*`로 `(본문|첨부)` 뒤에 오는 발신기관명 등 추가 텍스트를 허용합니다.

**매칭 그룹:**
1. `([^-]+)` — 기관명 (수신기관)
2. `(\d+)` — 공문 번호
3. `(본문|첨부)` — 문서 타입

## 실제 예시

### 본문 파일
```
(인창고등학교-22206 (본문) 경기도구리남양주교육지원청) [제출] AI 중점학교 운영 신청.pdf
```

**추출 결과:**
- 기관명: `인창고등학교`
- 공문번호: `22206`
- 타입: `본문`
- 공문 키: `인창고등학교-22206`
- 폴더명: `(인창고등학교-22206 (본문) 경기도구리남양주교육지원청) [제출] AI 중점학교 운영 신청`

### 첨부 파일
```
(인창고등학교-22206 (첨부) 경기도구리남양주교육지원청) [붙임1] 신청서.hwpx
(인창고등학교-22206 (첨부) 경기도구리남양주교육지원청) [붙임2] 계획서.xlsx
```

→ 동일한 공문 키 `인창고등학교-22206` → 본문과 같은 폴더로 이동

## 변형

| 케이스 | 예시 |
|---|---|
| 짧은 부서명 | `(인창고등학교-568 (본문) 구리남양주교육지원청) [제출] 디지털튜터.pdf` |
| 붙임 없음 | `(인창고등학교-673 (본문) 경기도교육청) 행정업무 보안관리 안내.pdf` |
| 부서명 없음 | `(인창고등학교-1003 (본문)) 2025 학생선도부 운영 현황.pdf` |

## 확장자

```
.pdf   — 주로 본문
.hwp   — 한글 (구버전)
.hwpx  — 한글 (신버전)
.xlsx  — 엑셀
.xls   — 엑셀 (구버전)
.cell  — 한셀
.ozd   — 지출품의서 등
.jpg   — 이미지 첨부
.png   — 이미지 첨부
```

## 특수 케이스

### 본문 없이 첨부만 있는 경우
→ 폴더명: `공문_인창고등학교-999`

### 같은 공문번호, 다른 기관
→ 기관명이 다르면 다른 공문 키 (`인창고등학교-100` ≠ `구리고등학교-100`)

### 패턴 불일치 파일
→ 이동하지 않음, 원본 위치 유지, 콘솔에 경고 출력
